

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/jg-square.png">
  <link rel="icon" href="/img/jg.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="jin">
  <meta name="keywords" content="">
  
    <meta name="description" content="å®ç°ä¸€ä¸ªå…·æœ‰å®æ—¶äº¤äº’åŠŸèƒ½çš„å¼±ä¸å¯å‹ç¼© SPH æµä½“æ¨¡æ‹Ÿå™¨.">
<meta property="og:type" content="article">
<meta property="og:title" content="ä¸€ä¸ªç®€å•çš„ SPH æµä½“æ¨¡æ‹Ÿå™¨">
<meta property="og:url" content="https://disembo.github.io/Note/CG/simu-sph-simulator/index.html">
<meta property="og:site_name" content="Jin&#39;s Blog">
<meta property="og:description" content="å®ç°ä¸€ä¸ªå…·æœ‰å®æ—¶äº¤äº’åŠŸèƒ½çš„å¼±ä¸å¯å‹ç¼© SPH æµä½“æ¨¡æ‹Ÿå™¨.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/sketch.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cubic-spline-kernel.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/surface-deficiency.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/whirpool-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/whirpool-2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/force-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/force-2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cube-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cube-2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cube-3.png">
<meta property="article:published_time" content="2025-02-14T14:30:00.000Z">
<meta property="article:modified_time" content="2025-04-06T14:20:28.982Z">
<meta property="article:author" content="jin">
<meta property="article:tag" content="ç‰©ç†">
<meta property="article:tag" content="è®¡ç®—æœºå›¾å½¢å­¦">
<meta property="article:tag" content="æ¨¡æ‹Ÿ">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/sketch.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>ä¸€ä¸ªç®€å•çš„ SPH æµä½“æ¨¡æ‹Ÿå™¨ | Jin&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/additional.css">
<link rel="stylesheet" href="/css/html-hint.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"disembo.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":3},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<!-- hexo injector head_end start --><script src="/js/mathjax-cfg.js"></script><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Jin&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>å‹é“¾</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ä¸€ä¸ªç®€å•çš„ SPH æµä½“æ¨¡æ‹Ÿå™¨"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-14 22:30" pubdate>
          2025å¹´2æœˆ14æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    

    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ä¸€ä¸ªç®€å•çš„ SPH æµä½“æ¨¡æ‹Ÿå™¨</h1>
            
            
              <div class="markdown-body">
                
                <html><head></head><body>
<div class="note note-secondary">
<p>æœ¬æ–‡æ˜¯ã€Šå¯è§†è®¡ç®—ä¸äº¤äº’ã€‹è¯¾ç¨‹çš„å¤§ä½œä¸šç¬”è®°, ä¸»è¦å‚è€ƒä¸€ç¯‡æ•™ç¨‹<span class="hint--html hint--top hint--hoverable hint--rounded hint--autosize"><hcontent class="hint__content">https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf</hcontent><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref" style="text-decoration: none;"><sup>[1]</sup></a></span>å’Œä¸€ä¸ªåœ¨çº¿ demo<span class="hint--html hint--top hint--hoverable hint--rounded hint--autosize"><hcontent class="hint__content">https://interactivecomputergraphics.github.io/physics-simulation/examples/wcsph.html</hcontent><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref" style="text-decoration: none;"><sup>[2]</sup></a></span>.</p>
<p>æœ¬æ–‡ä¾§é‡äºä»‹ç» SPH ç®—æ³•çš„æ€æƒ³, ç»™å‡ºä¸€äº›ç®€å•çš„å…¬å¼å’Œæ¨å¯¼,
ä»¥åŠä¸€äº›å®ç°ä¸Šçš„ç»†èŠ‚, åŸºæœ¬ä¸ä¼šæ¶‰åŠ SPH å„ç§ç®—æ³•çš„ç†è®ºç»†èŠ‚.</p>
<p>ğŸ—ï¸ æ–½å·¥ä¸­...</p>
</div>
<h2 id="foundations">1  Foundations</h2>
<p>è®¡ç®—æœºæµä½“æ¨¡æ‹Ÿæœ‰ä¸¤ç§è§†è§’, Eulerian å’Œ Lagrangian. Eulerian
å°†ç©ºé—´ç¦»æ•£åŒ–, æ¨¡æ‹Ÿç©ºé—´ç½‘æ ¼ä¸Šæ¯ä¸€ç‚¹çš„å¯†åº¦ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦åœº; è€Œ Lagrangian
å°†æµä½“ç¦»æ•£é‡‡æ ·ä¸ºç²’å­, æ¨¡æ‹Ÿæ¯ä¸ªé‡‡æ ·ç‚¹ (ç²’å­) å¤„çš„å¯†åº¦ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ç­‰.
Lagrangian æ–¹æ³•åœ¨å¤„ç†å¤æ‚æˆ–åŠ¨æ€è¾¹ç•Œä¸Šæ¯”è¾ƒæœ‰ä¼˜åŠ¿.</p>
<p><strong>SPH (smoothed particles hydrodynamics,
å…‰æ»‘ç²’å­æµä½“åŠ¨åŠ›å­¦)</strong> æ–¹æ³•æ˜¯ä¸€ç§åŸºäº Lagrangian è§†è§’çš„æ¨¡æ‹Ÿç®—æ³•.
SPH çš„åŸºæœ¬æ€æƒ³æ˜¯ç”¨ (ç©ºé—´ä¸­) ç¦»æ•£çš„é‡‡æ ·ç‚¹æ¥ä»£æ›¿è¿ç»­çš„ç‰©ç†é‡, å¦‚å¯†åº¦ç­‰.
è¿™äº›ç¦»æ•£çš„é‡‡æ ·ç‚¹ä¹Ÿç§°ä¸º "ç²’å­", æ¯ä¸ªç²’å­ <span class="math inline">\(p\in\R^d\)</span> éƒ½æºå¸¦ç€ç‰©ç†é‡ <span class="math inline">\(A(p)\)</span>, è€Œä»»æ„ä¸€ç‚¹å¤„çš„ç‰©ç†é‡ <span class="math inline">\(A(x)\)</span> (<span class="math inline">\(x\in\R^d\)</span>) å¯ä»¥é€šè¿‡ "æ ¸å‡½æ•°" æ’å€¼å¾—åˆ°,
å¦‚ä¸‹å›¾.</p>
<p><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/sketch.png" style="zoom:30%;" cloud-img="" lazyload="true"></p>
<p>æ­¤å¤–, å¾®åˆ†ç®—å­ (å¦‚æ¢¯åº¦, æ•£åº¦ç­‰) ä¹Ÿæœ‰å…¶ç¦»æ•£åŒ–ç‰ˆæœ¬.
å°†ç‰©ç†é‡å’Œå¾®åˆ†ç®—å­ç¦»æ•£åŒ–ä¹‹å, æˆ‘ä»¬å°±å¯ä»¥å°†æµä½“åŠ›å­¦æ–¹ç¨‹å†™æˆç¦»æ•£çš„ç‰ˆæœ¬,
æŠŠè¿ç»­æµä½“åŠ¨åŠ›å­¦é—®é¢˜è½¬åŒ–ä¸ºç²’å­ç›¸äº’ä½œç”¨é—®é¢˜, é€šè¿‡ Euler ç§¯åˆ†æ³•æ±‚è§£.</p>
<h3 id="kernel-functions">1.1  Kernel functions</h3>
<p>å–æ ¸å‡½æ•°ä¸º Dirac delta åˆ†å¸ƒ <span class="math inline">\(\delta(x)\)</span>, å®ƒå¯ä»¥ç²—ç•¥åœ°ç†è§£ä¸º <span class="math inline">\(\delta(x)=\Cases{\infty,&amp;x=0,\\0,&amp;x\neq0,}\)</span>
å¹¶ä¸”æ»¡è¶³å½’ä¸€åŒ–æ¡ä»¶ <span class="math display">\[
\int_{\R^d} \delta(x)\dd{x} = 1.
\]</span> å®ƒçš„ä¸€ä¸ªé‡è¦æ€§è´¨æ˜¯å¯¹ä»»æ„å…‰æ»‘ç´§æ”¯å‡½æ•° <span class="math inline">\(A:\R^d\to\R\)</span>, æœ‰ <span class="math display">\[
A(x) = (A*\delta)(x) = \int_{\R^d} A(p)\delta(x-p)\dd{p}.
\label{convDelta}\tag{a}
\]</span> ä¸Šå¼çš„å«ä¹‰æ˜¯, å¦‚æœé‡‡æ ·ç‚¹ <span class="math inline">\(p\)</span> éå¸ƒæ•´ä¸ªç©ºé—´ <span class="math inline">\(\R^d\)</span>, é‚£ä¹ˆå°±å¯ä»¥ç”¨è¿™äº›é‡‡æ ·ç‚¹çš„å€¼ <span class="math inline">\(A(p)\)</span> å’Œ <span class="math inline">\(\delta(x)\)</span> çš„å·ç§¯æ¥æå–å‡½æ•°å€¼ <span class="math inline">\(A(x)\)</span>. ä½†æ˜¯ delta åˆ†å¸ƒæ˜¯ä¸€ä¸ªå¹¿ä¹‰å‡½æ•°,
æ— æ³•ç›´æ¥ç”¨äºæ•°å€¼è®¡ç®—, æ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ªæ ¸å‡½æ•° <span class="math inline">\(W_h(x)\)</span> è¿‘ä¼¼å®ƒ (<span class="math inline">\(h\)</span> æ˜¯ä¸€ä¸ªæ­£å®å‚æ•°). æˆ‘ä»¬å¸Œæœ› <span class="math inline">\(W_h(x)\)</span> æ»¡è¶³å¦‚ä¸‹æ€§è´¨:</p>
<ol type="1">
<li>(å½’ä¸€åŒ–) <span class="math inline">\(\int_{\R^d} W_h(x)\dd{x} =
1\)</span>.</li>
<li>(é€ç‚¹æ”¶æ•›åˆ° delta åˆ†å¸ƒ) <span class="math inline">\(\lim_{h\to0}W_h(x)=\delta(x)\)</span>.</li>
<li>(å¯¹ç§°æ€§) <span class="math inline">\(W_h(x)=W_h(-x)\)</span> å¯¹ä»»æ„
<span class="math inline">\(x\in\R^d\)</span>.</li>
<li>(ç´§æ”¯æ€§) <span class="math inline">\(W_h(x)\equiv0\)</span> å¯¹ä»»æ„
<span class="math inline">\(\|x\|\geq h\)</span>, å…¶ä¸­ <span class="math inline">\(h&gt;0\)</span> ç”¨äºæ§åˆ¶æ”¯é›†çš„åŠå¾„.
(æœ‰çš„æ–‡çŒ®ä¸­ç”¨å¦ä¸€ä¸ªå‚æ•° <span class="math inline">\(\hbar\)</span>
æ§åˆ¶æ”¯åŠå¾„, æœ¬æ–‡ä¸­ä¸åšåŒºåˆ†.)</li>
<li>(<span class="math inline">\(C^2\)</span> å¯å¾®æ€§) <span class="math inline">\(W_h\)</span> æ˜¯äºŒé˜¶è¿ç»­å¯å¾®çš„.</li>
</ol>
<p>å…¶ä¸­ <span class="math inline">\(C^2\)</span>
å¯å¾®æ€§æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–äºŒé˜¶å¾®åˆ†ç®—å­. ä¸ºäº†ç‰©ç†æ¨¡æ‹Ÿçš„åˆç†æ€§,
æœ‰æ—¶ä¼šåŠ ä¸€ä¸ªæ¡ä»¶:</p>
<ul>
<li>(éè´Ÿæ€§) <span class="math inline">\(W_h(x)\geq0\)</span> å¯¹ä»»æ„
<span class="math inline">\(x\in\R^d\)</span>.</li>
</ul>
<p>æœ‰äº†æ ¸å‡½æ•° <span class="math inline">\(W_h(x)\)</span>, å¼ <span class="math inline">\(\eqref{convDelta}\)</span> å°±å¯ä»¥æ”¹å†™æˆ</p>
<p><span class="math display">\[
A(x) \approx (A*W_h)(x) = \int_{\R^d} A(p)W_h(x-p)\dd{p}.
\label{convApprox}\tag{b}
\]</span></p>
<div class="note note-secondary">
<p>å¼ <span class="math inline">\(\eqref{convApprox}\)</span>
çš„è¯¯å·®åˆ†æ. ä»¤ <span class="math inline">\(h\to0\)</span>. æ ¹æ® <span class="math inline">\(W_h\)</span> çš„ç´§æ”¯æ€§, è¢«ç§¯å‡½æ•°åªæœ‰ <span class="math inline">\(\|x-p\|&lt;h\to0\)</span> æ—¶éé›¶. å¯¹ <span class="math inline">\(A\)</span> åœ¨ <span class="math inline">\(x\)</span> å¤„ Taylor å±•å¼€, <span class="math display">\[
\Align{
A(p) = A(x)
&amp;+{} \sum_i \partial_iA(x) (p^i-x^i) \\
&amp;+{} \sum_{ij} \partial_{ij}A(x) (p^i-x^i)(p^j-x^j) \\
&amp;+{} o(\|p-x\|^2),
}
\]</span> ä»£å…¥ <span class="math inline">\(\eqref{convApprox}\)</span>
å¼å¾—åˆ° <span class="math display">\[
\Align{
\int_{\R^d} A(p) W_h(x-p)\dd{p}
&amp;= A(x)
  \underbrace{\int_{\R^d} W_h(x-p) \dd{p}}_1 \\
&amp;\hspace{1em}+{}
  \sum_i \partial_iA(x)
  \underbrace{\int_{\R^d} W_h(x-p) (p^i-x^i) \dd{p}}_0 \\
&amp;\hspace{1em}+{}
  \sum_{ij} \underbrace{\partial_{ij}A(x)}_{\mathcal{O}(1)}
  \underbrace{
      \int_{\R^d} W_h(x-p) (p^i-x^i)(p^j-x^j) \dd{p}
  }_{\mathcal{O}(h^2)} + o(h^2) \\
&amp;= A(x) + \mathcal{O}(h^2),
}
\]</span> (æ ¹æ®å½’ä¸€åŒ–æ€§è´¨, ç¬¬ä¸€ä¸ªç§¯åˆ†ä¸º <span class="math inline">\(1\)</span>; æ ¹æ®å¯¹ç§°æ€§, ç¬¬äºŒä¸ªç§¯åˆ†ä¸ºé›¶;
ç”±å…‰æ»‘æ€§å’Œç´§æ”¯æ€§, <span class="math inline">\(A\)</span>
çš„å„é˜¶åå¯¼æ•°æœ‰ç•Œ) å› æ­¤å¼ <span class="math inline">\(\eqref{convApprox}\)</span> å…·æœ‰ <span class="math inline">\(h^2\)</span> çº§åˆ«çš„è¯¯å·®, æ”¯åŠå¾„ <span class="math inline">\(h\)</span> è¶Šå°, ç²¾åº¦è¶Šé«˜.</p>
</div>
<p>ä¸€ä¸ªå¸¸ç”¨çš„æ ¸å‡½æ•°æ˜¯<strong>ä¸‰æ¬¡æ ·æ¡æ ¸å‡½æ•° (cubic spline
kernel)</strong> <span class="math display">\[
W_h(x) = \sigma_d \Cases{
6(q^3-q^2) + 1, &amp; 0\leq q\leq\frac12, \\
2(1-q^3), &amp; \frac12&lt;q\leq1, \\
0, &amp; \textsf{otherwise},
}
\]</span> å…¶ä¸­ <span class="math inline">\(q=\|x\|/h\)</span>;
å½’ä¸€åŒ–å› å­ <span class="math inline">\(\sigma_d\)</span> ä¸ç»´æ•°æœ‰å…³,
å¯¹äº <span class="math inline">\(d=1,2,3\)</span>, åˆ†åˆ«æœ‰ <span class="math inline">\(\sigma_d=\frac{4}{3h},\frac{40}{7\pi
h^2},\frac{8}{\pi h^3}\)</span>. äºŒç»´çš„ <span class="math inline">\(W_h\)</span> å›¾åƒå¦‚ä¸‹ (å›¾æºæ•™ç¨‹<span class="hint--html hint--top hint--hoverable hint--rounded hint--autosize"><hcontent class="hint__content">https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf</hcontent><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref" style="text-decoration: none;"><sup>[3]</sup></a></span>).</p>
<p><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cubic-spline-kernel.png" style="zoom:35%;" cloud-img="" lazyload="true"></p>
<h3 id="discretizing-field-quantities">1.2  Discretizing field
quantities</h3>
<p>ä¸ºäº†è®¡ç®—, éœ€è¦æŠŠç§¯åˆ†ç¦»æ•£ä¸ºæ±‚å’Œ. è®¾æµä½“çš„å¯†åº¦åœºä¸º <span class="math inline">\(\rho(x)\)</span>, åˆ™è´¨é‡ <span class="math inline">\(\dd{m}=\rho(x)\dd{V}=\rho(x)\dd{x}\)</span>.
å–é‡‡æ ·ç‚¹ <span class="math inline">\(p_1,\dots,p_n\)</span>, è®° <span class="math inline">\(\rho_i:=\rho(p_i)\)</span>, <span class="math inline">\(A_i:=A(p_i)\)</span>, <span class="math inline">\(m_i\)</span> ä¸ºç²’å­ <span class="math inline">\(p_i\)</span> çš„è´¨é‡, åˆ™ <span class="math display">\[
\Align{
A_i = A(p_i)
&amp;\approx \int_{\R^n} \frac{A(p)}{\rho(p)} W_h(p_i-p)
    \cdot \underbrace{\rho(p)\dd{p}}_{\dd{m}} \\
&amp;\approx \sum_{j=1}^n A_j\frac{m_j}{\rho_j} W_h(p_i-p_j) =: \lr{A_i}
} \label{disField}\tag{c}
\]</span> ä¸ºäº†æ–¹ä¾¿, è®° <span class="math inline">\(W_{ij}:=W_h(p_i-p_j)\)</span>.
æ³¨æ„æ ¸å‡½æ•°çš„ç´§æ”¯æ€§æ¡ä»¶, è¿™ä½¿å¾—å½“ <span class="math inline">\(\|p_i-p_j\|\geq h\)</span> æ—¶ <span class="math inline">\(W_{ij}=0\)</span>, å¤§å¤§å‡å°‘äº†æ±‚å’Œçš„é¡¹æ•°,
æé«˜äº†æ¨¡æ‹Ÿçš„æ•ˆç‡ (å³åªéœ€è€ƒè™‘ <span class="math inline">\(h\)</span>-é‚»åŸŸå†…çš„ç²’å­).</p>
<p>ç‰¹åˆ«åœ°, å– <span class="math inline">\(A(x)\)</span> ä¸ºå¯†åº¦åœº <span class="math inline">\(\rho(x)\)</span>, å³å¾—åˆ°å¯†åº¦åœºçš„ç¦»æ•£åŒ–å…¬å¼ <span class="math display">\[
\rho_i \approx \lr{\rho_i} = \sum_{j=1}^n m_j W_{ij},
\label{disRho}\tag{d}
\]</span> åªéœ€è®°å½•æ¯ä¸ªç²’å­çš„è´¨é‡ <span class="math inline">\(m_i\)</span>, å°±èƒ½è¿˜åŸå‡ºæ¯ä¸ªç²’å­å¤„çš„å¯†åº¦.
éœ€è¦æ³¨æ„çš„æ˜¯, ç”±äºé è¿‘æ¶²ä½“è¡¨é¢çš„ç²’å­å…¶é‚»åŸŸå†…ç²’å­è¾ƒå°‘ (å¦‚ä¸‹å›¾, å›¾æºæ•™ç¨‹<span class="hint--html hint--top hint--hoverable hint--rounded hint--autosize"><hcontent class="hint__content">https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf</hcontent><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref" style="text-decoration: none;"><sup>[4]</sup></a></span>),
ä½¿ç”¨ä¸Šå¼ä¼šå¯¼è‡´æ¶²ä½“è¡¨é¢çš„å¯†åº¦è¢«ä½ä¼°, éœ€è¦è¿›è¡Œè¡¥å¿.</p>
<p><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/surface-deficiency.png" style="zoom:25%;" cloud-img="" lazyload="true"></p>
<div class="note note-secondary">
<p>å¼ <span class="math inline">\(\eqref{disField}\)</span> çš„è¯¯å·®åˆ†æ.
å°† <span class="math inline">\(A\)</span> çš„ Taylor å±•å¼€ä»£å…¥ <span class="math inline">\(\eqref{disField}\)</span> å¼å³è¾¹, å¾—åˆ° <span class="math display">\[
\Align{
\lr{A_i}
&amp;= \orange{A_i} \sum_j\frac{m_j}{\rho_j} W_h(p_i-p_j) \\
&amp;\hspace{1em}{}+ \nabla A(p_i)
  \cdot\sum_j(p_j-p_i)\frac{m_j}{\rho_j} W_h(p_i-p_j) \\
&amp;\hspace{1em}{}+ \mathcal{O}(\|p_j-p_i\|^2).
}
\]</span> å¯è§, ä¸ºäº†è¾¾åˆ°é›¶é˜¶ç²¾åº¦, åº”æœ‰ <span class="math display">\[
\sum_j\frac{m_j}{\rho_j}W_h(p_i-p_j)=1.
\]</span> ä¸ºäº†è¾¾åˆ°ä¸€é˜¶ç²¾åº¦, åº”è¿›ä¸€æ­¥æœ‰ <span class="math display">\[
\sum_j(p_j-p_i)\frac{m_j}{\rho_j} W_h(p_i-p_j)=0.
\]</span></p>
</div>
<h3 id="discretizing-differential-operators">1.3  Discretizing differential
operators</h3>
<p>ç›´æ¥å¯¹ <span class="math inline">\(\eqref{disField}\)</span>
å¼æ±‚æ¢¯åº¦, å¯ä»¥å¾—åˆ°æ¢¯åº¦çš„ç›´æ¥è¿‘ä¼¼, <span class="math display">\[
\nabla A_i
\approx
\nabla \lr{A_i} = \sum_j A_j \frac{m_j}{\rho_j} \nabla W_{ij}.
\]</span></p>
<div class="note note-secondary">
<p>è¯¥å¼çš„è¯¯å·®åˆ†æ. å°† <span class="math inline">\(A\)</span> çš„ Taylor
å±•å¼€ä»£å…¥ä¸Šå¼, å¾—åˆ° <span class="math display">\[
\Align{
\nabla \lr{A_i}
&amp;= A_i \sum_j \frac{m_j}{\rho_j} \nabla W_{ij} \\
&amp;\hspace{1em}{}+ \orange{\nabla A(p_i)}
  \cdot \sum_j (p_j-p_i) \frac{m_j}{\rho_j} \nabla W_{ij} \\
&amp;\hspace{1em}{}+ \mathcal{O}(\|p_j-p_i\|^2).
}
\]</span> ä¸ºäº†è¾¾åˆ°é›¶é˜¶ (ä¸€é˜¶) ç²¾åº¦, åº”æˆç«‹ä¸‹é¢å·¦å¼ (ä¸¤å¼) <span class="math display">\[
\Align{
\lr{\nabla1}\equiv
\sum_j \frac{m_j}{\rho_j} \nabla W_{ij} &amp;= 0, &amp;
\sum_j \frac{m_j}{\rho_j} (p_j-p_i) \otimes \nabla W_{ij}
  &amp;= {\rm id}_d.
}
\]</span></p>
</div>
<p>è¿™ç§ "ç›´æ¥è¿‘ä¼¼" ä¸€èˆ¬è¯¯å·®æ¯”è¾ƒå¤§, ä¸”ä¼šå¯¼è‡´æ¨¡æ‹Ÿä¸ç¨³å®š.
ä¸‹é¢æˆ‘ä»¬ç»™å‡ºåœ¨å®é™…ä¸­å¸¸ç”¨çš„ä¸¤ç§æ¢¯åº¦å…¬å¼.</p>
<p>æ¢¯åº¦çš„<strong>å·®åˆ†å…¬å¼ (difference formula)</strong> ä¸º <span class="math display">\[
\nabla A_i\approx \sum_j\frac{m_j}{\rho_j} (A_j-A_i)\nabla_iW_{ij}.
\]</span> å®ƒå¯ä»¥ä¿è¯ <span class="math inline">\(0\)</span> é˜¶å‡†ç¡®æ€§ (å³
<span class="math inline">\(\nabla A_i\)</span> çš„å€¼å‡†ç¡®).</p>
<p>æ¢¯åº¦çš„<strong>å¯¹ç§°å…¬å¼ (symmetric formula)</strong> ä¸º <span class="math display">\[
\nabla{A_i}
\approx \rho_i \sum_j m_j \pqty{
\frac{A_i}{\rho_i^2}+\frac{A_j}{\rho_j^2} }
\nabla_i W_{ij}.
\label{symFormula}\tag{f}
\]</span> å®ƒä¸èƒ½ä¿è¯ <span class="math inline">\(0\)</span> é˜¶å‡†ç¡®æ€§,
ä½†å…¶ä¼˜ç‚¹æ˜¯èƒ½ä¿è¯åŠ¨é‡å’Œè§’åŠ¨é‡å®ˆæ’ (å¯¹ç§°æ€§å¯ä»¥ä¿è¯å†…åŠ›ä¹‹å’Œä¸ºé›¶).
ä¸ºä¿è¯çœŸå®æ€§, ä¸€èˆ¬é‡‡ç”¨å¯¹ç§°å…¬å¼.</p>
<h3 id="fluid-equations">1.4  Fluid equations</h3>
<p>ä¸ºäº†æ¨¡æ‹Ÿæµä½“çš„è¿åŠ¨, æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€äº›ç‰©ç†æ–¹ç¨‹. åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­,
æˆ‘ä»¬ä¸»è¦å…³æ³¨æµä½“çš„å®è§‚è¡Œä¸º, å¿½ç•¥é‚£äº›äººç±»ä¸å¯æ„ŸçŸ¥çš„å¾®è§‚è¡Œä¸º.
ä¸‹é¢æˆ‘ä»¬ä»‹ç»ä¸€äº›æ¨¡æ‹Ÿæµä½“æ—¶æ‰€éœ€çš„å®šå¾‹.</p>
<p><strong>è¿ç»­æ€§æ–¹ç¨‹</strong>æè¿°äº†æµä½“å¯†åº¦çš„æ¼”åŒ–: <span class="math display">\[
\frac{D\rho}{Dt} = -\rho(\nabla\cdot v).
\label{contEq}\tag{g}
\]</span> å…¶ä¸­, <span class="math inline">\(D/Dt\)</span> ç§°ä¸ºéšä½“å¯¼æ•°
(material derivative), æŒ‡çš„æ˜¯ç‰©ç†é‡éšç€æµä½“å¾®å›¢è¿åŠ¨è€Œå˜åŒ–çš„æ—¶é—´å˜åŒ–ç‡
(åœ¨æˆ‘ä»¬çš„æ¨¡æ‹Ÿä¸­, ç‰©è´¨å¯¼æ•°å°±æ˜¯æŸä¸ª "ç²’å­" æºå¸¦çš„ç‰©ç†é‡çš„å˜åŒ–ç‡).
éšä½“å¯¼æ•°å¯åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†: <span class="math display">\[
\frac{DA}{Dt} = \pdv{A}{t} + v\cdot\nabla A,
\]</span> å…¶ä¸­ <span class="math inline">\(\partial{A}/\partial{t}\)</span>
æ˜¯å›ºå®šçš„ä¸€ç‚¹å¤„çš„ç‰©ç†é‡çš„å˜åŒ–ç‡, <span class="math inline">\(v\cdot\nabla
A\)</span> æ˜¯ç‰©ç†é‡ç”±äºæµä½“å¾®å›¢è¿åŠ¨è€Œäº§ç”Ÿçš„å˜åŒ–ç‡.</p>
<p>ä¸€èˆ¬çš„æµä½“ (æ¯”å¦‚å¸¸æ¸©å¸¸å‹ä¸‹ä½é€ŸæµåŠ¨çš„æ°´, æ²¹) æ˜¯ä¸å¯å‹ç¼©çš„, å³ <span class="math inline">\(D\rho/Dt=0\)</span>. ä»è¿ç»­æ€§æ–¹ç¨‹çœ‹å‡º,
æµä½“çš„ä¸å¯å‹ç¼©æ€§ç­‰ä»·äº <span class="math inline">\(\nabla\cdot
v=0\)</span>. æˆ‘ä»¬çš„æ¨¡æ‹Ÿéœ€è¦åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿è¯ä¸å¯å‹ç¼©æ€§.</p>
<p><strong>åŠ¨é‡å®ˆæ’å®šå¾‹</strong>: <span class="math display">\[
\rho\frac{Dv}{Dt} = \nabla\cdot T + f^{\sf ext}.
\]</span> å…¶ä¸­ <span class="math inline">\(T\)</span> ä¸ºåº”åŠ›å¼ é‡, <span class="math inline">\(f^{\sf ext}\)</span> ä¸º (å•ä½ä½“ç§¯çš„) å¤–åŠ›.
åº”åŠ›å¼ é‡æè¿°äº†æµä½“å†…éƒ¨æŸä¸€ç‚¹çš„ (å•ä½é¢ç§¯çš„) å—åŠ›çŠ¶å†µ.</p>
<p><strong>Navier-Stokes æ–¹ç¨‹</strong>ç»™å‡ºäº†åº”åŠ›å¼ é‡, <span class="math display">\[
T = -p1_{d} + \mu(\nabla v+\nabla v\T),
\]</span> å…¶ä¸­ <span class="math inline">\(p\)</span> ä¸ºå‹å¼º, <span class="math inline">\(\mu\)</span> ä¸ºç²˜åº¦ç³»æ•°. ç²˜æ»é˜»åŠ›å¯ä»¥å¹³æ»‘é€Ÿåº¦åœº,
ä¿è¯æ¨¡æ‹Ÿçš„ç¨³å®šæ€§. å‹å¼ºæœ‰ä¸¤ç§è®¡ç®—æ–¹æ³•:</p>
<ul>
<li><p>(å¼ºä¸å¯å‹ç¼©) å¦‚æœè¦ä¸¥æ ¼ä¿è¯ä¸å¯å‹ç¼©æ€§, åˆ™éœ€è¦ä¸€äº›é¢å¤–çš„åŠŸå¤«,
è¿™é‡Œä¸åšä»‹ç».</p></li>
<li><p>(å¼±ä¸å¯å‹ç¼©) å¦‚æœæ— éœ€ä¸¥æ ¼ä¿è¯ä¸å¯å‹ç¼©æ€§,
åˆ™å¯ä»¥åˆ©ç”¨<strong>çŠ¶æ€æ–¹ç¨‹</strong> <span class="math display">\[
p = k\pqty{\pqty{\frac{\rho}{\rho_0}}^\gamma-1},
\label{stateEq}\tag{h}
\]</span> é€šè¿‡å¯†åº¦ <span class="math inline">\(\rho\)</span> è®¡ç®—å‹å¼º
<span class="math inline">\(p\)</span>. å…¶ä¸­, <span class="math inline">\(\rho_0\)</span> æ˜¯å¯†åº¦çš„åŸºå‡† (ç§°ä¸ºæ¾å¼›å¯†åº¦, rest
density), å¦‚æœå¯†åº¦ <span class="math inline">\(\rho&gt;\rho_0\)</span>,
åˆ™ç»™äºˆä¸€ä¸ªè¾ƒå¤§çš„å‹å¼ºä½¿å¾—ç²’å­é—´ç›¸äº’æ’æ–¥, å‡å°å¯†åº¦. å¸¸æ•° <span class="math inline">\(k,\gamma&gt;0\)</span> æ§åˆ¶æµä½“ä¸å¯å‹ç¼©çš„çº§åˆ«,
å€¼è¶Šå¤§è¶Šä¸å¯å‹ç¼©.</p></li>
</ul>
<p>å°† Navier-Stokes æ–¹ç¨‹ä»£å…¥åŠ¨é‡å®ˆæ’å®šå¾‹, å¾—åˆ° <span class="math display">\[
\rho\frac{Dv}{Dt} = -\nabla p + \mu\nabla^2v + f^{\sf ext}.
\]</span></p>
<h3 id="operator-splitting">1.5  Operator splitting</h3>
<p>æ±‚è§£ä¸Šè¿°åå¾®åˆ†æ–¹ç¨‹çš„ä¸€ä¸ªé‡è¦æ€æƒ³æ˜¯åŒ–æ•´ä¸ºé›¶. "ç®—å­åˆ†è£‚" (operator
splitting) å³æŠŠä¸€ä¸ªå¤§æ–¹ç¨‹åŒ–ä¸ºå‡ ä¸ª (é¡ºåºçš„) å­é—®é¢˜,
å¹¶é‡‡ç”¨å•ç‹¬çš„æŠ€æœ¯æ¥æ±‚è§£æ¯ä¸ªå­é—®é¢˜.</p>
<p>åœ¨ SPH é—®é¢˜ä¸­, é’ˆå¯¹ä¸åŒåº”ç”¨åœºæ™¯å’Œæµä½“æ€§è´¨å¯ä»¥æœ‰ä¸åŒçš„åˆ†è£‚æ–¹æ³•,
ä¸‹é¢å¼•å…¥ä¸€ç§ä½ç²˜åº¦å¼±ä¸å¯å‹ç¼©æµä½“çš„ç®—å­åˆ†è£‚æ–¹æ³•.</p>
<p>å¯¹äºæ¯ä¸ª time step, å°†æ¨¡æ‹Ÿåˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ­¥éª¤:</p>
<ol type="1">
<li><p><strong>è®¡ç®—æ¯ä¸ªç²’å­å¤„çš„å¯†åº¦å’Œå‹å¼º</strong>: (å¼ <span class="math inline">\(\eqref{disRho}\)</span> å’Œå¼ <span class="math inline">\(\eqref{stateEq}\)</span>) <span class="math display">\[
\Align{
\rho_i &amp;\leftarrow \sum_j m_j W_{ij}, \\
p_i &amp;\leftarrow k\pqty{\pqty{\frac{\rho_i}{\rho_0}}^\gamma-1}.
}
\]</span></p></li>
<li><p><strong>è®¡ç®—æ¯ä¸ªç²’å­å¤„çš„å—åŠ›å’ŒåŠ é€Ÿåº¦</strong>:</p>
<ul>
<li><p>å‹åŠ›: (åˆ©ç”¨å¯¹ç§°å…¬å¼ <span class="math inline">\(\eqref{symFormula}\)</span>) <span class="math display">\[
\Align{
F_i^{\sf pressure}
&amp;\leftarrow -\frac1{\rho}\nabla p
= -m_i\sum_j m_j\pqty{\frac{p_i}{\rho_i^2}+\frac{p_j}{\rho_j^2}}
\nabla W_{ij}.
}
\]</span></p></li>
<li><p>ç²˜æ»é˜»åŠ›: <span class="math display">\[
F_i^{\sf visc} \leftarrow \mu\sum_j \frac{m_j}{\rho_j}(v_j-v_i).
\]</span></p></li>
<li><p>åŠ é€Ÿåº¦: <span class="math display">\[
a_i \leftarrow \frac1{m_i}
(F_i^{\sf pressure}+F_i^{\sf visc}+F_i^{\sf ext}),
\]</span> å…¶ä¸­å¤–åŠ›ä¸ºé‡åŠ›.</p></li>
</ul></li>
<li><p><strong>æ ¹æ®åŠ é€Ÿåº¦æ›´æ–°é€Ÿåº¦ä¸ä½ç½®</strong> (åŠéšå¼ Euler ç§¯åˆ†):
<span class="math display">\[
\Align{
v_i' &amp;\leftarrow v_i + a_i\Delta t, \\
x_i' &amp;\leftarrow x_i + v_i\Delta t.
}
\]</span></p>
<ul>
<li>æ­¥é•¿ <span class="math inline">\(\Delta t\)</span> å³å¯ä»¥æ˜¯å›ºå®šå€¼,
ä¹Ÿå¯ä»¥æ ¹æ®æ¨¡æ‹ŸçŠ¶å†µåŠ¨æ€è°ƒæ•´. ä¸ºäº†ä¿è¯ç¨³å®šæ€§, ä¸€èˆ¬å– <span class="math display">\[
\Delta t\leq \lambda\frac{\tilde h}{\|v\|_{\sf max}},
\]</span> å…¶ä¸­ <span class="math inline">\(\tilde{h}\)</span>
ä¸ºç²’å­å¤§å°, <span class="math inline">\(\lambda\)</span> ä¸ºå‚æ•° (å¯ä»¥å–
<span class="math inline">\(0.4\)</span>). ä¸Šå¼ç§°ä¸º
Courant-Friedrichs-Lewy (CFL) æ¡ä»¶, æ˜¯ä¿è¯æ¨¡æ‹Ÿæ”¶æ•›çš„ <span class="math inline">\(\Delta t\)</span> çš„ä¸€ä¸ªä¸Šç•Œ.</li>
</ul></li>
</ol>
<h3 id="neighbourhood-search">1.6  Neighbourhood search</h3>
<p>è®¡ç®—å¯†åº¦å’ŒåŠ é€Ÿåº¦çš„æ­¥éª¤éƒ½éœ€è¦æŸ¥æ‰¾ç²’å­çš„ <span class="math inline">\(h\)</span>-é‚»åŸŸå†…çš„ç²’å­, æœ´ç´ çš„ç®—æ³•å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^2)\)</span>, å½“ç²’å­å¾ˆå¤šæ—¶æ˜¾ç„¶ä¸å¯è¡Œ.
ä¸€ç§åŠ é€Ÿç®—æ³•æ˜¯å°†ç©ºé—´åˆ’åˆ†ä¸ºé—´è·ä¸º <span class="math inline">\(h\)</span>
çš„ç½‘æ ¼, å°†ç²’å­ä»¥ç½‘æ ¼ç´¢å¼• <span class="math inline">\((i,j,k)\)</span> ä¸º
key å­˜å‚¨åœ¨ä¸€å¼ è¡¨é‡Œ (ç§°ä¸º<strong>é‚»åŸŸè¡¨</strong>). è¿™æ ·,
é‚»åŸŸæœç´¢æ—¶åªéœ€æŸ¥æ‰¾è¯¥ç²’å­å‘¨å›´ <span class="math inline">\(3Ã—3Ã—3\)</span>
ç½‘æ ¼å†…çš„ç²’å­å³å¯.</p>
<p>ä¸ºäº†è¾¾åˆ° <span class="math inline">\(O(1)\)</span> çš„æŸ¥æ‰¾æ•ˆç‡,
å¯ä»¥ä½¿ç”¨ hash è¡¨. å¤„äºç¬¬ <span class="math inline">\((i,j,k)\)</span>
ç½‘æ ¼çš„ç²’å­ä»¥ hash å€¼ <span class="math display">\[
(pi\mathop{\rm XOR}qj\mathop{\rm XOR}rk)\mathop{\rm mod}{N}
\]</span> ä¸ºç´¢å¼• (å…¶ä¸­ <span class="math inline">\({\rm XOR}\)</span>
ä¸ºæŒ‰ä½å¼‚æˆ–, <span class="math inline">\(p,q,r\)</span> æ˜¯å¤§è´¨æ•°, <span class="math inline">\(N\)</span> ä¸ºè¡¨æ ¼é•¿åº¦).</p>
<h3 id="boundaries">1.7  Boundaries</h3>
<p>SPH å¤„ç†è¾¹ç•Œæœ‰ä¸¤ç§å¸¸ç”¨åšæ³•, ç¬¬ä¸€ç§æ˜¯ç”¨å›ºå®šä¸åŠ¨çš„ç²’å­æ¨¡æ‹Ÿè¾¹ç•Œ;
ç¬¬äºŒç§æ˜¯ç”¨ç¬¦å·è·ç¦»åœº (SDF) è®°å½•è¾¹ç•Œ, å½“ç²’å­é è¿‘è¾¹ç•Œæ—¶ä»¤å…¶åå¼¹.
æˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸€ç§, å› ä¸ºå®ƒä¸€æ–¹é¢å®ç°èµ·æ¥è¾ƒå®¹æ˜“,
æ¯ä¸€å¸§æ›´æ–°æ—¶æ— éœ€é¢å¤–çš„è¾¹ç•Œé€»è¾‘; å¦ä¸€æ–¹é¢èƒ½å¤Ÿå®ç°å¤æ‚çš„è¾¹ç•Œ.
è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä¸è¶³æ˜¯éœ€è¦å¾ˆå¤šé¢å¤–çš„ç²’å­, è¿˜å¯èƒ½å‡ºç°ç²’å­é€¸å‡ºçš„æƒ…å†µ.
ä¸ºäº†ç¼“è§£ç²’å­é€¸å‡º, ç¨‹åºé‡‡ç”¨åŒå±‚è¾¹ç•Œ.</p>
<p>åˆå§‹åŒ–è¾¹ç•Œæ—¶éœ€è¦ä¸ºå…¶èµ‹äºˆ "ä¼ªè´¨é‡", ä½¿å¾—æ¯ä¸ªè¾¹ç•Œç²’å­å¤„çš„å¯†åº¦å€¼ç­‰äº
<span class="math inline">\(\rho_0\)</span>.</p>
<h2 id="an-implementation">2  An implementation</h2>
<h3 id="sph-solver">2.1  SPH solver</h3>
<p>ä¸ºäº†å®æ—¶äº¤äº’, æœ¬ç¨‹åºé‡‡ç”¨è®¡ç®—è´Ÿæ‹…è¾ƒå°çš„å¼±å¯å‹ç¼© SPH ç®—æ³• (WCSPH) é…åˆ
symplectic Euler ç§¯åˆ†. å…·ä½“æ­¥éª¤å·²ç»åœ¨ä¸Šæ–‡ç»™å‡º.</p>
<p><strong>WCSPH ç®—æ³•</strong>. æ›´æ–°æ­¥éª¤åœ¨ä¸Šé¢å·²ç»ç»™å‡º,
åªéœ€åœ¨ç¬¬ä¸€æ­¥ä¹‹å‰å†åŠ å…¥ä¸€æ­¥ "è®¡ç®—é‚»åŸŸè¡¨".</p>
<p><strong>å¹¶è¡Œè®¡ç®—</strong>. ä¸ºäº†åŠ é€Ÿ, ç¨‹åºä½¿ç”¨
<code>std::thread</code> å®ç°å¤šçº¿ç¨‹. åœ¨æ¯ä¸€å¸§çš„æ›´æ–°è¿‡ç¨‹ä¸­,
è®¡ç®—å¯†åº¦ã€å‹åŠ›ã€åŠ é€Ÿåº¦ã€æ›´æ–°é€Ÿåº¦å’Œä½ç½®è¿™å‡ ä¸ªæ“ä½œ,
ä¸åŒçš„ç²’å­æ˜¯å®Œå…¨ä¸å¹²æ‰°çš„, å¯ä»¥ç›´æ¥å¹¶è¡Œ, æ¯ä¸ªçº¿ç¨‹å„è´Ÿè´£ä¸€éƒ¨åˆ†ç²’å­.
ä½†æ›´æ–°é‚»åŸŸè¡¨æ—¶, ä¸åŒç²’å­å¯èƒ½å†™åˆ°åŒä¸€è¡¨é¡¹, éœ€è¦åŠ é”. å®æµ‹å‘ç°å¹¶è¡Œè®¡ç®—å¯¹
2D åœºæ™¯æ•ˆæœä¸æ˜æ˜¾, å¯¹ 3D åœºæ™¯åŠ é€Ÿä½œç”¨æ˜æ˜¾.</p>
<h3 id="visualization">2.2  Visualization</h3>
<p><strong>Shader 2D</strong>. äºŒç»´çš„ç²’å­æ¸²æŸ“ä¸ºå°åœ†çƒ.
ä¸ºäº†æ›´å¥½è§‚å¯Ÿå°çƒçš„é€Ÿåº¦ç­‰ä¿¡æ¯, å°çƒæŒ‰ç…§å…¶é€Ÿåº¦ç€è‰²:</p>
<ul>
<li>ä»é€Ÿåº¦æ…¢åˆ°å¿«, åˆ†åˆ«ä¸ºè“è‰²ã€é»„è‰²ã€çº¢è‰². é¢œè‰²æŒ‰ç…§ç»è¿‡ sigmoid
å‡½æ•°å˜æ¢åçš„é€Ÿåº¦ <span class="math inline">\(\|v\|\)</span> çº¿æ€§æ’å€¼.
é¢œè‰²å¯ä»¥è°ƒæ•´.</li>
</ul>
<p>åœ¨å®ç°ä¸Š, åªéœ€ç»™ particle çš„ shader ä¼ å…¥ Velocities å‘é‡, åœ¨ vert
shader é‡Œé¢è®¡ç®—æ¨¡é•¿å¹¶ä¼ å…¥ frag shader, æ¥ç€åœ¨ frag shader
é‡Œæ’å€¼å³å¯.</p>
<p>ä¸ºäº†å®ç°åœ†çƒçš„æ•ˆæœ, éœ€è¦ä½¿ç”¨ <code>gl_PointCoord</code> å‘é‡,
å®ƒè®°å½•äº†å½“å‰åƒç´ åœ¨å½“å‰ particle ä¸­çš„å½’ä¸€åŒ–åæ ‡. å°†å…¶ç¼©æ”¾åˆ° <span class="math inline">\([-1,1]^2\)</span> èŒƒå›´å†…å, ä¸¢å¼ƒå•ä½åœ†å¤–çš„ç‚¹.</p>
<p><strong>Shader 3D</strong>. ä¸‰ç»´çš„ç²’å­æ¸²æŸ“ä¸º 3D ç«‹ä½“å°çƒ. é¢œè‰²æ–¹æ¡ˆä¸
2D ä¸€æ ·. æ­¤å¤–è¿˜å®ç°äº† Phong-Blinn å…‰ç…§.</p>
<p><strong>ä¸åŒçš„åœºæ™¯</strong>. ç›®å‰æœ‰ 4 ä¸ª 2D åœºæ™¯ (Square, Circle,
Rotating cirlce, Pool) å’Œ 2 ä¸ª 3D åœºæ™¯ (Cube, Cylinder). å…¶ä¸­, 2D åœºæ™¯
Rotating circle æ˜¯ä¸€ä¸ªæ—‹è½¬çš„ "æ…æ‹Œæœº", é€šè¿‡åœ¨æ›´æ–°æ—¶æ—‹è½¬è¾¹ç•Œç‚¹æ¥å®ç°
(å®ç°é€»è¾‘å¹¶ä¸å¤æ‚, å¯ä»¥çœ‹ä½œ Lagrangian æ–¹æ³•çš„ä¼˜åŠ¿ä¹‹ä¸€).</p>
<h3 id="interaction">2.3  Interaction</h3>
<p>å—åˆ°å·²æœ‰æ¨¡æ‹Ÿå™¨çš„å¯å‘,
æˆ‘åœ¨æ¨¡æ‹Ÿç¨‹åºä¸­å®ç°äº†æ·»åŠ ç²’å­ã€æ–½åŠ å¤–åŠ›è¿™ä¸¤ä¸ªåŠŸèƒ½,
ä¸ºæ¨¡æ‹Ÿæ·»åŠ äº†ä¸ç¡®å®šæ€§å’Œä¸€äº›ä¹è¶£.</p>
<p><strong>æ·»åŠ ç²’å­</strong>.
æŒ‰ä¸‹æŒ‰é’®å¯ä»¥åœ¨åœºæ™¯ä¸Šæ–¹å›ºå®šä½ç½®ç”Ÿæˆå›ºå®šå¤§å°çš„ç«‹æ–¹ä½“. éœ€è¦æ³¨æ„çš„æ˜¯,
æ·»åŠ ç²’å­æœ€å¥½ä¿è¯è¯¥åŒºåŸŸå†…æ²¡æœ‰å¤ªå¤šå…¶ä»–ç²’å­, å¦åˆ™å¯èƒ½å¯¼è‡´ç²’å­é‡å è€Œçˆ†ç‚¸. 2D
å’Œ 3D åœºæ™¯åˆ†åˆ«æœ‰æœ€å¤§ç²’å­æ•°çš„é™åˆ¶.</p>
<p><strong>æ–½åŠ å¤–åŠ› (ä»… 2D)</strong>. é¼ æ ‡å·¦é”®æŒ‰ä¸‹å¹¶ç§»åŠ¨, å°±ä¼šåœ¨åŠå¾„
<span class="math inline">\(kh\)</span> (<span class="math inline">\(h\)</span> æ˜¯ kernel åŠå¾„)
ä¹‹å†…æ–½åŠ ä¸ç§»åŠ¨é€Ÿåº¦æˆæ­£æ¯”çš„å¤–åŠ›. åŠå¾„ <span class="math inline">\(k\)</span> å¯ä»¥è°ƒæ•´. éœ€è¦æ³¨æ„çš„æ˜¯,
ç§»åŠ¨é€Ÿåº¦è¿‡å¿«å¯èƒ½å¯¼è‡´èƒ½é‡è¿‡å¤§è€Œçˆ†ç‚¸.</p>
<p>ä¸‰ç»´åœºæ™¯çš„æ–½åŠ å¤–åŠ›åŠŸèƒ½æ²¡æœ‰å®ç°. ç”±äºç›¸æœºæŠ•å½±çš„ ambiguity,
ç›®å‰è¿˜æ²¡æœ‰æƒ³åˆ°ä¸€ä¸ªå¥½åŠæ³•å¤„ç†. æœªæ¥çš„å·¥ä½œè¿˜åŒ…æ‹¬è§£å†³äº¤äº’ä¸­ "çˆ†ç‚¸"
çš„é—®é¢˜.</p>
<h3 id="results">2.4  Results</h3>
<p><strong>2D</strong>.</p>
<p>æ¸²æŸ“çš„å¸§ç‡åŸºæœ¬ç¨³å®šåœ¨ 120 fps, æ¨¡æ‹Ÿçš„é€Ÿåº¦ä¸çº¿ä¸Š demo ç›¸æ¯”æ…¢ä¸€ç‚¹,
ä½†ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„æ°´å¹³. æ¨¡æ‹Ÿé€Ÿåº¦å’Œå¸§ç‡å—ç²’å­æ•°å½±å“ä¸å¤§.</p>
<p>é€Ÿåº¦å¯è§†åŒ–è®©ä¸€äº›ç°è±¡å˜å¾—ç›´è§‚. å¯ä»¥è§‚å¯Ÿåˆ°æµä½“ä¸­çš„å¤šä¸ªæ¼©æ¶¡: (ä¸ºäº†ç›´è§‚,
å°†ç²’å­å¤§å°è°ƒåˆ°æœ€å¤§)</p>
<table>

<thead>
<tr>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/whirpool-1.png" style="width:260px" cloud-img="" lazyload="true"></th>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/whirpool-2.png" style="width:260px" cloud-img="" lazyload="true"></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>ç”¨é¼ æ ‡æ·»åŠ å¤–åŠ›, å¯ä»¥æ˜æ˜¾è§‚å¯Ÿåˆ°æ³¢çš„äº§ç”Ÿå’Œåå°„:</p>
<table>

<thead>
<tr>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/force-1.png" style="width:260px;" cloud-img="" lazyload="true"></th>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/force-2.png" style="width:260px;" cloud-img="" lazyload="true"></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p><strong>3D</strong>.</p>
<p>Cube åœºæ™¯:</p>
<table>

<thead>
<tr>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cube-1.png" style="width:240px" cloud-img="" lazyload="true"></th>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cube-2.png" style="width:240px" cloud-img="" lazyload="true"></th>
<th style="text-align: center;"><img src="https://raw.githubusercontent.com/Disembo/blog-media/master/cg/sph-simulator/cube-3.png" style="width:240px" cloud-img="" lazyload="true"></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>æ¨¡æ‹Ÿå’Œæ¸²æŸ“çš„é€Ÿåº¦å—ç²’å­æ•°é‡å½±å“è¾ƒå¤§. å½“ç²’å­æ•°è¾ƒå°‘æ—¶, æ¸²æŸ“çš„å¸§ç‡ç¨³å®šåœ¨
120 fps, æ¨¡æ‹Ÿé€Ÿåº¦ç•¥å¿«äº 2D. å½“ç²’å­æ•°è¾ƒå¤§æ—¶, æ¨¡æ‹Ÿé€Ÿåº¦ä¸å¤ªç¨³å®š (ç‰¹åˆ«æ˜¯ add
particles åæ–°æ—§æµä½“æ¥è§¦æ—¶).</p>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn2"><p>https://interactivecomputergraphics.github.io/physics-simulation/examples/wcsph.html<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn3"><p>https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn4"><p>https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf<a href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
</ol>
</section>
</body></html>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Note/" class="category-chain-item">Note</a>
  
  
    <span>></span>
    
  <a href="/categories/Note/CG/" class="category-chain-item">CG</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%89%A9%E7%90%86/" class="print-no-link">#ç‰©ç†</a>
      
        <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/" class="print-no-link">#è®¡ç®—æœºå›¾å½¢å­¦</a>
      
        <a href="/tags/%E6%A8%A1%E6%8B%9F/" class="print-no-link">#æ¨¡æ‹Ÿ</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ä¸€ä¸ªç®€å•çš„ SPH æµä½“æ¨¡æ‹Ÿå™¨</div>
      <div>https://disembo.github.io/Note/CG/simu-sph-simulator/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>jin</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2025å¹´2æœˆ14æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - ç›¸åŒæ–¹å¼å…±äº«">
                    <i class="iconfont icon-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/Note/CG/cg-index/" title="è®¡ç®—æœºå›¾å½¢å­¦ç¬”è®°">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">è®¡ç®—æœºå›¾å½¢å­¦ç¬”è®°</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/Note/tp-gtm218/6/" title="GTM218 | 6 å…‰æ»‘æ˜ å°„çš„å±€éƒ¨æ€§æ€">
                        <span class="hidden-mobile">GTM218 | 6 å…‰æ»‘æ˜ å°„çš„å±€éƒ¨æ€§æ€</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'Disembo/blog-comments');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        Views: 
        <span id="busuanzi_value_site_pv"></span>
        
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        Visitors: 
        <span id="busuanzi_value_site_uv"></span>
        
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
